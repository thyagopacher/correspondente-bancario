(function(b){if(!b.browser){b.browser={};b.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase());b.browser.webkit=/webkit/.test(navigator.userAgent.toLowerCase());b.browser.opera=/opera/.test(navigator.userAgent.toLowerCase());b.browser.msie=/msie/.test(navigator.userAgent.toLowerCase())}var a={destroy:function(){b(this).unbind(".maskMoney");if(b.browser.msie){this.onpaste=null}return this},mask:function(c){return this.each(function(){var e=b(this),d;if(typeof c==="number"){e.trigger("mask");d=b(e.val().split(/\D/)).last()[0].length;c=c.toFixed(d);e.val(c)}return e.trigger("mask")})},unmasked:function(){return this.map(function(){var e=(b(this).val()||"0"),c=e.indexOf("-")!==-1,d;b(e.split(/\D/).reverse()).each(function(f,g){if(g){d=g;return false}});e=e.replace(/\D/g,"");e=e.replace(new RegExp(d+"$"),"."+d);if(c){e="-"+e}return parseFloat(e)})},init:function(c){c=b.extend({prefix:"",suffix:"",affixesStay:true,thousands:",",decimal:".",precision:2,allowZero:false,allowNegative:false},c);return this.each(function(){var d=b(this),p;c=b.extend(c,d.data());function t(){var z=d.get(0),C=0,x=0,B,y,w,v,A;if(typeof z.selectionStart==="number"&&typeof z.selectionEnd==="number"){C=z.selectionStart;x=z.selectionEnd}else{y=document.selection.createRange();if(y&&y.parentElement()===z){v=z.value.length;B=z.value.replace(/\r\n/g,"\n");w=z.createTextRange();w.moveToBookmark(y.getBookmark());A=z.createTextRange();A.collapse(false);if(w.compareEndPoints("StartToEnd",A)>-1){C=x=v}else{C=-w.moveStart("character",-v);C+=B.slice(0,C).split("\n").length-1;if(w.compareEndPoints("EndToEnd",A)>-1){x=v}else{x=-w.moveEnd("character",-v);x+=B.slice(0,x).split("\n").length-1}}}}return{start:C,end:x}}function g(){var y=!(d.val().length>=d.attr("maxlength")&&d.attr("maxlength")>=0),x=t(),A=x.start,w=x.end,z=(x.start!==x.end&&d.val().substring(A,w).match(/\d/))?true:false,v=(d.val().substring(0,1)==="0");return y||z||v}function s(v){d.each(function(x,y){if(y.setSelectionRange){y.focus();y.setSelectionRange(v,v)}else{if(y.createTextRange){var w=y.createTextRange();w.collapse(true);w.moveEnd("character",v);w.moveStart("character",v);w.select()}}})}function k(w){var v="";if(w.indexOf("-")>-1){w=w.replace("-","");v="-"}return v+c.prefix+w+c.suffix}function o(y){var x=(y.indexOf("-")>-1&&c.allowNegative)?"-":"",A=y.replace(/[^0-9]/g,""),B=A.slice(0,A.length-c.precision),z,w,v;B=B.replace(/^0*/g,"");B=B.replace(/\B(?=(\d{3})+(?!\d))/g,c.thousands);if(B===""){B="0"}z=x+B;if(c.precision>0){w=A.slice(A.length-c.precision);v=new Array((c.precision+1)-w.length).join(0);z+=c.decimal+v+w}return k(z)}function i(w){var v=d.val().length,x;d.val(o(d.val()));x=d.val().length;w=w-(v-x);s(w)}function r(){var v=d.val();d.val(o(v))}function l(){var v=d.val();if(c.allowNegative){if(v!==""&&v.charAt(0)==="-"){return v.replace("-","")}else{return"-"+v}}else{return v}}function j(v){if(v.preventDefault){v.preventDefault()}else{v.returnValue=false}}function q(B){B=B||window.event;var y=B.which||B.charCode||B.keyCode,v,z,x,w,A;if(y===undefined){return false}if(y<48||y>57){if(y===45){d.val(l());return false}else{if(y===43){d.val(d.val().replace("-",""));return false}else{if(y===13||y===9){return true}else{if(b.browser.mozilla&&(y===37||y===39)&&B.charCode===0){return true}else{j(B);return true}}}}}else{if(!g()){return false}else{j(B);v=String.fromCharCode(y);z=t();x=z.start;w=z.end;A=d.val();d.val(A.substring(0,x)+v+A.substring(w,A.length));i(x+1);return false}}}function h(B){B=B||window.event;var y=B.which||B.charCode||B.keyCode,z,x,w,A,v;if(y===undefined){return false}z=t();x=z.start;w=z.end;if(y===8||y===46||y===63272){j(B);A=d.val();if(x===w){if(y===8){if(c.suffix===""){x-=1}else{v=A.split("").reverse().join("").search(/\d/);x=A.length-v-1;w=x+1}}else{w+=1}}d.val(A.substring(0,x)+A.substring(w,A.length));i(x);return false}else{if(y===9){return true}else{return true}}}function f(){p=d.val();r();var v=d.get(0),w;if(v.createTextRange){w=v.createTextRange();w.collapse(false);w.select()}}function m(){setTimeout(function(){r()},0)}function u(){var v=parseFloat("0")/Math.pow(10,c.precision);return(v.toFixed(c.precision)).replace(new RegExp("\\.","g"),c.decimal)}function n(w){if(b.browser.msie){q(w)}if(d.val()===""||d.val()===k(u())){if(!c.allowZero){d.val("")}else{if(!c.affixesStay){d.val(u())}else{d.val(k(u()))}}}else{if(!c.affixesStay){var v=d.val().replace(c.prefix,"").replace(c.suffix,"");d.val(v)}}if(d.val()!==p){d.change()}}function e(){var v=d.get(0),w;if(v.setSelectionRange){w=d.val().length;v.setSelectionRange(w,w)}else{d.val(d.val())}}d.unbind(".maskMoney");d.bind("keypress.maskMoney",q);d.bind("keydown.maskMoney",h);d.bind("blur.maskMoney",n);d.bind("focus.maskMoney",f);d.bind("click.maskMoney",e);d.bind("cut.maskMoney",m);d.bind("paste.maskMoney",m);d.bind("mask.maskMoney",r)})}};b.fn.maskMoney=function(c){if(a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments)}else{b.error("Method "+c+" does not exist on jQuery.maskMoney")}}}})(window.jQuery||window.Zepto);